На практике часто нужно работать с элементами одного [[Создание и устройство тензоров в PyTorch|тензора]], например найти их арифметическую сумму, вычислить среднее значение, найти максимум/минимум и т.д.. Рассмотрим на примере как это делается:
## Базовые функции/методы для работы с элементами тензора:
###### Арифметическая сумма элементов тензора:
```Python
a = torch.FloatTensor([1, 2, 3, 10, 20, 30])

# Арифметическая сумма элементов тензора
print(torch.sum(a)) # tensor(66.)
print(a.sum()) # tensor(66.)
print(torch.sum(a).item()) # 66.0
print(a.sum().item()) # 66.0
```
###### Среднее арифметическое элементов тензора:
```Python
a = torch.FloatTensor([1, 2, 3, 10, 20, 30])

# Среднее арифметическое элементов тензора
print(torch.mean(a)) # tensor(11.)
print(a.mean()) # tensor(11.)
print(torch.mean(a).item()) # 11.0
print(a.mean().item()) # 11.0
```
###### Максимальный элемент тензора:
```Python
a = torch.FloatTensor([1, 2, 3, 10, 20, 30])

# Максимальный элемент тензора
print(torch.max(a)) # tensor(30.)
print(a.max()) # tensor(30.)
print(torch.max(a).item()) # 30.0
print(a.max().item()) # 30.0

# Индекс максимального элемента тензора
print(torch.argmax(a)) # tensor(5)
print(a.argmax()) # tensor(5)
print(torch.argmax(a).item()) # 5
print(a.argmax().item()) # 5
```
###### Минимальный элемент тензора:
```Python
a = torch.FloatTensor([1, 2, 3, 10, 20, 30])

# Минимальный элемент тензора
print(torch.min(a)) # tensor(1.)
print(a.min()) # tensor(1.)
print(torch.min(a).item()) # 1.0
print(a.min().item()) # 1.0

# Индекс минимального элемента тензора
print(torch.argmin(a)) # tensor(0)
print(a.argmin()) # tensor(0)
print(torch.argmin(a).item()) # 0
print(a.argmin().item()) # 0
```
###### Модуль тензора:
```Python
a = torch.FloatTensor([1, 2, 3, 10, 20, 30])

# Модуль элементов тензора
print(torch.abs(a)) # tensor([ 1.,  2.,  3., 10., 20., 30.])
print(a.abs()) # tensor([ 1.,  2.,  3., 10., 20., 30.])
a.abs_()
print(a) # tensor([ 1.,  2.,  3., 10., 20., 30.])
```
###### Округление элементов до ближайшего целого:
```Python
a = torch.FloatTensor([1.5, 2.3, -3.7, 1.0, 2.75, 3.0])

# Модуль элементов тензора
print(torch.round(a)) # tensor([ 2.,  2., -4.,  1.,  3.,  3.])
print(a.round()) # tensor([ 2.,  2., -4.,  1.,  3.,  3.])
a.round_()
print(a) # tensor([ 2.,  2., -4.,  1.,  3.,  3.])
```
###### Вычисление натурального логарифма:
```Python
a = torch.FloatTensor([1, 2, 3, 10, 20, 30])

# Модуль элементов тензора
print(torch.log(a)) # tensor([0.0000, 0.6931, 1.0986, 2.3026, 2.9957, 3.4012])
print(a.log()) # tensor([0.0000, 0.6931, 1.0986, 2.3026, 2.9957, 3.4012])
a.log_() # tensor([0.0000, 0.6931, 1.0986, 2.3026, 2.9957, 3.4012])
```
###### Вычисление логарифма с основанием 2:
```Python
a = torch.FloatTensor([1, 2, 3, 10, 20, 30])

# Модуль элементов тензора
print(torch.log2(a)) # tensor([0.0000, 1.0000, 1.5850, 3.3219, 4.3219, 4.9069])
print(a.log2()) # tensor([0.0000, 1.0000, 1.5850, 3.3219, 4.3219, 4.9069])
a.log2_()
print(a) # tensor([0.0000, 1.0000, 1.5850, 3.3219, 4.3219, 4.9069])
```
###### Вычисление десятичного логарифма:
```Python
a = torch.FloatTensor([1, 2, 3, 10, 20, 30])

# Модуль элементов тензора
print(torch.log10(a)) # tensor([0.0000, 0.3010, 0.4771, 1.0000, 1.3010, 1.4771])
print(a.log10()) # tensor([0.0000, 0.3010, 0.4771, 1.0000, 1.3010, 1.4771])
a.log10_()
print(a) # tensor([0.0000, 0.3010, 0.4771, 1.0000, 1.3010, 1.4771])
```
Для многомерных тензоров приведенные выше методы/функции выполняются абсолютно идентично за исключением одной особенности - можно выбрать ось, относительно которой эти методы/функции будут выполняться:
```Python
a = torch.FloatTensor([1, 2, 3, 10, 20, 30]).view(3, 2)
# Арифметическая сумма
print(a.sum()) # tensor(66.)
print(a.sum(dim=0)) # tensor([24., 42.])
print(a.sum(dim=1)) # tensor([ 3., 13., 50.])

# Среднее арифметическое тензора
print(a.mean()) # tensor(1.)
print(a.mean(dim=0)) # tensor([ 8., 14.])
print(a.mean(dim=1)) # tensor([ 1.5000,  6.5000, 25.0000])

# Максимальный(-ые) элемент(-ы) тензора
print(a.max()) # tensor(30.)
print(a.max(dim=0)) 
# torch.return_types.max( 
# values=tensor([20., 30.]),
# indices=tensor([2, 2]))
print(a.max(dim=0)).values # tensor([20., 30.])
print(a.amax(dim=0)) # tensor([20., 30.])

# Минимальный(-ые) элемент(-ы) тензора
print(a.min()) # tensor(1.)
print(a.min(dim=0)) 
# torch.return_types.min(
# values=tensor([1., 2.]),
# indices=tensor([0, 0]))
print(a.min(dim=0)).values # tensor([1., 2.])
print(a.amin(dim=0)) # tensor([1., 2.])

# Аналогично работает и для остальных методов/функций

```
## Базовые тригонометрические функции/методы для работы с элементами тензора:
###### Синус элементов тензора:
```Python
a = torch.linspace(0, 2*torch.pi, 13) # tensor([0.0000, 0.5236, 1.0472, 1.5708, # 2.0944, 2.6180, 3.1416])
print(torch.sin(a)) # tensor([ 0.0000e+00,  5.0000e-01,  8.6603e-01,  
# 1.0000e+00,  8.6603e-01, 5.0000e-01, -8.7423e-08])

print(a.sin()) # tensor([ 0.0000e+00,  5.0000e-01,  8.6603e-01,  
# 1.0000e+00,  8.6603e-01, 5.0000e-01, -8.7423e-08])

a.sin_()
print(a) # tensor([ 0.0000e+00,  5.0000e-01,  8.6603e-01,  
# 1.0000e+00,  8.6603e-01, 5.0000e-01, -8.7423e-08])
```
###### Косинус элементов тензора:
```Python
a = torch.linspace(0, 2*torch.pi, 13) # tensor([0.0000, 0.5236, 1.0472, 1.5708, # 2.0944, 2.6180, 3.1416])
print(torch.cos(a)) # tensor([ 1.0000e+00,  8.6603e-01,  5.0000e-01, -4.3711e-
# 08, -5.0000e-01, -8.6603e-01, -1.0000e+00])

print(a.cos()) # tensor([ 1.0000e+00,  8.6603e-01,  5.0000e-01, -4.3711e-
# 08, -5.0000e-01, -8.6603e-01, -1.0000e+00])

a.cos_()
print(a) # tensor([ 1.0000e+00,  8.6603e-01,  5.0000e-01, -4.3711e-
# 08, -5.0000e-01, -8.6603e-01, -1.0000e+00])
```
###### Тангенс элементов тензора:
```Python
a = torch.linspace(0, 2*torch.pi, 13)

print(torch.tan(a)) # tensor([ 0.0000e+00,  5.7735e-01,  1.7321e+00, 
# -2.2877e+07, -1.7321e+00, -5.7735e-01,  8.7423e-08])

print(a.tan()) # tensor([ 0.0000e+00,  5.7735e-01,  1.7321e+00, 
# -2.2877e+07, -1.7321e+00, -5.7735e-01,  8.7423e-08])

a.tan_()
print(a) # tensor([ 0.0000e+00,  5.7735e-01,  1.7321e+00, -2.2877e+07, 
# -1.7321e+00, -5.7735e-01,  8.7423e-08])
```
###### Арксинус элементов тензора
```Python
a = torch.FloatTensor([0, 0.5, 0.7071, 0.8660, 1])

print(torch.arcsin(a)) # tensor([0.0000, 0.5236, 0.7854, 1.0471, 1.5708])
print(a.arcsin()) # tensor([0.0000, 0.5236, 0.7854, 1.0471, 1.5708])
a.arcsin_() 
print(a) # tensor([0.0000, 0.5236, 0.7854, 1.0471, 1.5708])
```
###### Аркосинус элементов тензора
```Python
a = torch.FloatTensor([0, 0.5, 0.7071, 0.8660, 1])

print(torch.arccos(a)) # tensor([1.5708, 1.0472, 0.7854, 0.5236, 0.0000])
print(a.arccos()) # tensor([1.5708, 1.0472, 0.7854, 0.5236, 0.0000])
a.arccos_() 
print(a) # tensor([1.5708, 1.0472, 0.7854, 0.5236, 0.0000])
```
###### Акртангенс элементов тензора
```Python
a = torch.FloatTensor([0, 0.5773, 1.7321, 1])

print(torch.arctan(a)) # tensor([0.0000, 0.5236, 1.0472, 0.7854])
print(a.arctan()) # tensor([0.0000, 0.5236, 1.0472, 0.7854])
a.arctan_() 
print(a) # tensor([0.0000, 0.5236, 1.0472, 0.7854])
```

#CS #Python #PyTorch #Тензоры 