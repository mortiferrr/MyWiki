Нередко на практике случаются ситуации, когда [[Создание и устройство тензоров в PyTorch|тензоры]] хранятся в виде массивов NumPy, и их нужно перенести в тензоры фреймворка PyTorch. Рассмотрим, как это можно сделать:
```Python
d_np = np.array([[1, 2, 3], [4, 5, 6]]) # Массив array пакета NumPy

# Импорт массива array пакета NumPy в тензор фреймворка PyTorch
t2 = torch.from_numpy(d_np) # Копирует характеристику массива из NumPy
t3 = torch.tensor(d_np, dtype=torch.float32) # Может преобразовывать импортированные данные из массива NumPy (например, изменить тип данных)
```

Тензор, созданный при помощи метода *from_numpy()* использует те же самые ячейки памяти, что и массив NumPy, который использовался для его создания. Отсюда следует, что изменение этого массива NumPy отражается на тензоре, который был создан при помощи этого массива и наоборот соответсвенно.
```Python
d_np[0, 0] = 5
print(t2)
# tensor([[5, 2, 3],
#         [4, 5, 6]], dtype=torch.int32)

print(t3)
# tensor([[1., 2., 3.],
#         [4., 5., 6.]])
```
**Примечание:** Все вышесказанное не касается списков.

Рассмотрим как обратно конвертировать тензор PyTorch в массив NumPy:
```Python
d = t2.numpy() # В этом случае d и t2 зависят друг от друга
d = t2.numpy().copy() # В этом случае d и t2 не зависят друг от друга
```

Рассмотрим как преобразовать тип данных объектов, который хранит уже существующий (созданный) тензор:
```Python
tf = t2.float() # Преобразование в тип torch.float32
```
Методы преобразования типа данных объектов, которые хранит уже существующий(созданный) тензор:
![[Преобразование типа данных в тензоре PyTorch.png]]
**Примечание:** если преобразовать хранящий тип данных тензора в тот же самый, который он уже хранит, то новый тензор будет ссылаться на ту же память, что и старый.

#CS #Python #PyTorch #NumPy #Тензоры 