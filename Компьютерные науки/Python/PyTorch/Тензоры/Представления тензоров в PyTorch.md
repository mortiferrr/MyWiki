**Представления тензора** - это различные виды размещения элементов одного и того же [[Создание и устройство тензоров в PyTorch|тензора]] без добавления новых. То есть, число элементов остается одним и тем же, меняется только форма тензора. На рисунке ниже показан наглядный пример:
![[Представления тензоров.png]]
Создавать представления тензора можно двумя методами: *reshape()* и *view()* - оба выполняют  почти одинаковую функцию, но на практике чаще всего используется второй метод. Отличия между ними состоит в том, что метод *view()* требует тензор, хранящийся в непрерывном блоке памяти, а метод *reshape()* может самостоятельно решить проблему фрагментации памяти, поэтому он безопаснее. Рассмотрим как делать представления тензоров на примере:
```Python
x = torch.arange(4) # tensor([0, 1, 2, 3])
d = x.view(2, 2) # tesnsor([[0, 1], [2, 3]])
r = x.reshape(2, 2) # tesnsor([[0, 1], [2, 3]])
```

Также существует метод *resize_()*, меняет форму **и может изменить размер тензора**, даже если он не совпадает с исходным числом элементов. Это опасно, часто приводит к багам. Использовать с осторожностью:
```Python
x = torch.arange(6) # tensor([0, 1, 2, 3, 4, 5])
x.resize_(2, 2) # tensor([[0, 1], [2, 3]])
```

Часто на практике требуется развернуть тензор в вектор, это можно сделать при помощи метода *ravel()*.
```Python
x = torch.arange(6).view(2, 3) # tensor([[0, 1, 2], [3, 4, 5]])
r = x.ravel() # tensor([0, 1, 2, 3, 4, 5])
```

Чтобы поменять оси тензора местами используется метод *permute()*.
```Python
x = torch.arange(6).view(2, 3) # tensor([[0, 1, 2], [3, 4, 5]])
d = x.permute(1, 0) # tensor([[0, 1], [2, 3], [4, 5]])
```

Часто при работе с тензорами в PyTorch требуется удалять новые оси и добавлять существующие. Существует много способов это сделать, но самые распространенные - это методы torch.unsqueeze(x, dim) и torch.squeeze(x, \[, dim\]), первый метод добавляет новый ось, а второй удаляет (оба метода работают только с теми осями, которые имеют единичную размерность).
```Python
x = torch.arange(32).view(8, 2, 2) # Создаем 8x2x2 тензор

# Первый способ добавить ось
d = torch.unsqueeze(x, dim=0) # Первый аргумент - тензор, к которму требуется добавить ось, второй аргумент - индекс оси, которую мы добавляем
print(d.size()) # torch.Size([1, 8, 2, 2])
d = torch.unsqueeze(d, dim=-1) # Добавляем ось в конец
print(d.size()) # torch.Size([1, 8, 2, 2, 1])

# Второй способ добавить ось
r = x.unsqueeze(0) # В качестве аргумента указываем индекс оси, которую хотим добавить
print(r.size()) # torch.Size([1, 8, 2, 2])
r = r.unsqueeze(-1) # Добавляем ось в конец
print(r.size()) # torch.Size([1, 8, 2, 2, 1])

# Третий способ добавить ось
x.unsqueeze_(0) # В качестве аргумента указываем индекс оси, которую хотим добавить
print(x.size()) # torch.Size([1, 8, 2, 2])
x.unsqueeze_(-1) # Добавляем ось в конец
print(x.size()) # torch.Size([1, 8, 2, 2, 1])

c = torch.squeeze(x) # Удаляются все оси с единичной размерностью
print(c.size()) # torch.Size([8, 2, 2])
c = torch.squeeze(x, dim=0) # Удаляем первую ось
print(c.size()) # torch.Size([8, 2, 2, 1])
```
**Примечание:** различные представления одного и того же тензора ссылаются на одни и те же ячейки памяти.

#CS #Python #PyTorch #Тензоры 